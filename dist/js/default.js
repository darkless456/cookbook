$(document).on("pageinit","#index",function(){bindEvent.retrieval()}),$(document).on("pageinit","#detail",function(){$("#infoTitle").on("tap",function(){history.back(-1)})}),$(document).on("pageinit","#fav",function(){bindEvent.hot()});var prefs={isAjax:!1,local:window.localStorage,session:window.sessionStorage,recipelist:$("#book"),recipeinfo:$("#info"),favlist:$("favlist")},process=function(){var e={};return $.fn.extend({getVal:function(){return this.val()}}),e.getRecipeList=function(){$(this).button("option","disabled",!0),$.mobile.loading("show");var e=$("#recipe").getVal();$.getJSON("http://api.huceo.com/txapi/caipu/?key=721d38ca8ac658cd2cac2ae4b0131977&num=10",{word:e},function(e){if("200"!=e.code)return void prefs.recipelist.html(e.msg);prefs.recipelist.empty(),prefs.session.clear();var i=e.newslist;$.each(i,function(e,t){var n=$("<li>").appendTo(prefs.recipelist),o=$("<a>").prop("href","#detail").attr({"data-no":i[e].id,"data-transition":"slide"}).appendTo(n);$("<h2>").html(i[e].cp_name).appendTo(o),$("<p>").html(i[e].texing).appendTo(o),$("<p>").html(i[e].type_name).addClass("ui-li-aside").appendTo(o),process.save2Storage.call(t.id,t)}),prefs.recipelist.listview("refresh"),$("#book>li a").on("tap",function(){process.getRecipeDetail.call(this)})}),$(this).button("option","disabled",!1),$.mobile.loading("hide")},e.save2Storage=function(e){var i=[];$.each(e,function(e,t){i.push(e+":"+t)}),prefs.session.setItem(this,i.join("@"))},e.getRecipeDetail=function(){var e=$(this).attr("data-no"),i={},t=prefs.session[e],n=t.split("@");$.each(n,function(e,t){var n=t.split(":");i[n[0]]=n[1]}),prefs.recipeinfo.empty(),$("#infoTitle").html(i.cp_name),$("<li>").html("<h2>食材用料:</h2>"+process.subsection(i.yuanliao)).appendTo(prefs.recipeinfo),$("<li>").html("<h2>食材调味:</h2>"+process.subsection(i.tiaoliao)).appendTo(prefs.recipeinfo),$("<li>").html("<h2>食谱做法:</h2>"+process.subsection(i.zuofa)).appendTo(prefs.recipeinfo),$("<li>").html("<h2>小贴士:</h2><p>"+i.tishi+"</p>").appendTo(prefs.recipeinfo),$("<li>").html("<h2>菜肴特色:</h2><p>"+i.texing+"</p>").appendTo(prefs.recipeinfo)},e.subsection=function(e){var i=[],t=e.split("；");return $.each(t,function(e,t){i.push("<p>"+t+"</p>")}),i.join("")},e}(),bindEvent=function(){var e={};return e.retrieval=function(){$("#searchBtn").on("tap",function(e){process.getRecipeList.call(this)})},e.hot=function(){process.showFav()},e}(),process=function(e){return e.showFav=function(){$.mobile.loading("show"),$.getJSON("./script/toSQL.php",{showfav:"1"},function(e){prefs.favlist.empty(),prefs.session.clear();var i=e;$.each(i,function(e,t){var n=$("<li>").appendTo(prefs.favlist),o=$("<a>").prop("href","#detail").attr({"data-no":i[e].rid,"data-transition":"slide"}).appendTo(n);$("<h2>").html(i[e].name).appendTo(o),$("<p>").html(i[e].feature).appendTo(o),$("<p>").html(i[e].classify).addClass("ui-li-aside").appendTo(o),process.save2Storage.call(t.rid,t)}),prefs.favlist.listview("refresh"),$.mobile.loading("hide"),$("#favlist>li a").on("tap",function(){process.getRecipeDetail.call(this)})})},e.showFavDetail=function(){},e.save2SQL=function(){},e}(process);
//# sourceMappingURL=default.js.map
