{"version":3,"sources":["default.js"],"names":["$","document","on","bindEvent","retrieval","history","back","hot","prefs","isAjax","local","window","localStorage","session","sessionStorage","recipelist","recipeinfo","favlist","process","obj","fn","extend","getVal","this","val","getRecipeList","button","mobile","loading","keyword","getJSON","word","data","code","html","msg","empty","clear","datalist","newslist","each","index","value","oLi","appendTo","oA","prop","attr","data-no","data-transition","addClass","save2Storage","call","listview","getRecipeDetail","src","arr","push","setItem","join","id","json","res","split","tmp","subsection","_arr","e","showFav","showfav","showFavDetail","save2SQL"],"mappings":"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","file":"default.js","sourcesContent":["/*\n* @Author: darkless\n* @Date:   2016-03-30 17:52:09\n* @Last Modified by:   anchen\n* @Last Modified time: 2016-04-05 18:06:40\n*/\n\n\n\n$(document).on('pageinit', '#index', function(){\n    bindEvent.retrieval();\n})\n\n$(document).on('pageinit', '#detail', function(){\n    $('#infoTitle').on('tap', function(){\n        history.back(-1);\n    })\n})\n\n$(document).on('pageinit', '#fav', function(){\n    bindEvent.hot();\n})\n\n//参数\nvar prefs = {\n    isAjax: false,\n    local: window.localStorage,\n    session: window.sessionStorage,\n    recipelist: $('#book'),\n    recipeinfo: $('#info'),\n    favlist: $('favlist')\n};\n\n//处理函数\nvar process = (function(){\n    var obj = {};\n\n    $.fn.extend({\n        getVal: function(){\n            return this.val();\n        }\n    })\n\n    obj.getRecipeList = function(){\n        $(this).button('option','disabled',true);\n        $.mobile.loading('show');\n        var keyword = $('#recipe').getVal();\n        $.getJSON('http://api.huceo.com/txapi/caipu/?key=721d38ca8ac658cd2cac2ae4b0131977&num=10', {'word':keyword}, function(data){\n            // console.log(data);\n            if(data.code != '200'){\n                prefs.recipelist.html(data.msg);\n                return;\n            }\n            prefs.recipelist.empty();\n            prefs.session.clear();\n            var datalist = data.newslist;\n            $.each(datalist, function(index, value){\n                var oLi = $('<li>').appendTo(prefs.recipelist);\n                var oA = $('<a>').prop('href', '#detail').attr({'data-no': datalist[index]['id'],\n                    'data-transition': 'slide'}).appendTo(oLi);\n                $('<h2>').html(datalist[index]['cp_name']).appendTo(oA);\n                $('<p>').html(datalist[index]['texing']).appendTo(oA);\n                $('<p>').html(datalist[index]['type_name']).addClass('ui-li-aside').appendTo(oA);\n\n                process.save2Storage.call(value['id'],value);\n            })\n            prefs.recipelist.listview(\"refresh\");\n            $('#book>li a').on('tap', function(){\n                process.getRecipeDetail.call(this);\n            });\n        })\n        $(this).button('option', 'disabled', false);\n        $.mobile.loading('hide');\n\n    }\n    obj.save2Storage = function(src){\n        var arr = [];\n        $.each(src, function(index, value){\n            arr.push(index+':'+value);\n        })\n        prefs.session.setItem(this, arr.join('@'));\n    }\n\n    obj.getRecipeDetail = function(){\n        var id = $(this).attr('data-no');\n        var json = {};\n        var res = prefs.session[id];\n        var data = res.split('@');\n        $.each(data, function(index, value){\n            var tmp = value.split(':');\n            json[tmp[0]] = tmp[1];\n        })\n        prefs.recipeinfo.empty();\n        $('#infoTitle').html(json['cp_name']);\n        $('<li>').html('<h2>食材用料:</h2>'+process.subsection(json['yuanliao'])).appendTo(prefs.recipeinfo);\n        $('<li>').html('<h2>食材调味:</h2>'+process.subsection(json['tiaoliao'])).appendTo(prefs.recipeinfo);\n        $('<li>').html('<h2>食谱做法:</h2>'+process.subsection(json['zuofa'])).appendTo(prefs.recipeinfo);\n        $('<li>').html('<h2>小贴士:</h2><p>'+json['tishi']+'</p>').appendTo(prefs.recipeinfo);\n        $('<li>').html('<h2>菜肴特色:</h2><p>'+json['texing']+'</p>').appendTo(prefs.recipeinfo);\n        // $.mobile.changePage('#detail');\n    }\n\n    obj.subsection = function(src){\n        var _arr = [];\n        var tmp = src.split('；');\n        $.each(tmp, function(index, value){\n            _arr.push('<p>'+value+'</p>');\n        })\n        return _arr.join('');\n    }\n\n    return obj;\n}());\n\n//绑定事件函数\nvar bindEvent = (function(){\n    var obj = {};\n    obj.retrieval = function(){\n        $('#searchBtn').on('tap', function(e){\n            process.getRecipeList.call(this);\n        });\n    }\n\n    obj.hot = function(){\n        process.showFav();\n    }\n\n\n    return obj;\n})();\n\nvar process = (function(obj){\n    obj.showFav = function(){\n        $.mobile.loading('show');\n        $.getJSON('./script/toSQL.php', {'showfav': '1'}, function(data){\n            prefs.favlist.empty();\n            prefs.session.clear();\n            var datalist = data;\n            $.each(datalist, function(index, value){\n                var oLi = $('<li>').appendTo(prefs.favlist);\n                var oA = $('<a>').prop('href', '#detail').attr({'data-no': datalist[index]['rid'],'data-transition': 'slide'}).appendTo(oLi);\n                $('<h2>').html(datalist[index]['name']).appendTo(oA);\n                $('<p>').html(datalist[index]['feature']).appendTo(oA);\n                $('<p>').html(datalist[index]['classify']).addClass('ui-li-aside').appendTo(oA);\n\n                process.save2Storage.call(value['rid'],value);\n            })\n\n            prefs.favlist.listview(\"refresh\");\n            $.mobile.loading('hide');\n            $('#favlist>li a').on('tap', function(){\n                process.getRecipeDetail.call(this);\n            });\n        })\n    }\n\n    obj.showFavDetail = function(){\n\n    }\n\n    obj.save2SQL = function(){\n\n    }\n\n    return obj;\n}(process));"],"sourceRoot":"/source/"}